# 请求代码审查

## 何时激活

此技能在以下情况下自动激活：

- 完成一项任务后
- 准备提交代码前
- 准备发起 Pull Request 前
- 代码质量检查点

## 目标

此技能的目标是请求对代码进行审查，以确保代码质量。

在请求审查之前，你需要：

1. **自我审查代码：** 先自己检查代码
2. **运行测试：** 确保所有测试通过
3. **运行代码质量工具：** 确保代码符合标准
4. **准备审查材料：** 准备好审查所需的信息

## 步骤

### 1. 自我审查代码

在请求他人审查之前，先自己审查代码：

1. **检查代码逻辑：** 确保代码逻辑正确
2. **检查代码风格：** 确保代码风格一致
3. **检查命名：** 确保命名清晰
4. **检查注释：** 确保注释准确
5. **检查错误处理：** 确保错误处理正确

### 2. 运行测试

确保所有测试通过：

1. **运行相关测试：** 运行与更改相关的测试
2. **运行完整测试套件：** 运行整个测试套件
3. **检查测试覆盖率：** 确保测试覆盖率没有下降

### 3. 运行代码质量工具

确保代码符合质量标准：

1. **运行 linter：** 运行 linter 以检查代码风格
2. **运行类型检查：** 如果使用类型检查，确保类型检查通过
3. **运行静态分析：** 运行静态分析工具

### 4. 准备审查材料

准备好审查所需的信息：

1. **描述更改：** 描述更改的目的和内容
2. **链接到相关问题：** 链接到相关的问题或任务
3. **描述测试：** 描述如何测试更改
4. **描述注意事项：** 描述需要注意的事项

## 代码审查清单

在请求审查之前，完成以下检查清单：

- [ ] 代码逻辑正确
- [ ] 代码风格一致
- [ ] 命名清晰
- [ ] 注释准确
- [ ] 错误处理正确
- [ ] 所有测试通过
- [ ] 测试覆盖率没有下降
- [ ] Linter 通过
- [ ] 类型检查通过（如果适用）
- [ ] 没有引入安全漏洞
- [ ] 更改描述准确
- [ ] 链接到相关问题
- [ ] 测试说明清晰

## 审查报告格式

当请求代码审查时，使用以下格式：

```
## 代码审查请求

### 更改描述
[描述更改的目的和内容]

### 相关问题
[链接到相关问题或任务]

### 测试说明
[描述如何测试更改]

### 注意事项
[描述需要注意的事项]

### 检查清单
[链接到完成的检查清单]
```

## 审查反馈处理

当收到审查反馈时：

1. **仔细阅读反馈：** 仔细阅读所有反馈
2. **分类反馈：** 将反馈分类为关键、重要、建议
3. **回应反馈：** 及时回应反馈
4. **实施更改：** 实施必要的更改
5. **请求重新审查：** 如果需要，请求重新审查

## 反馈严重程度

### 关键问题

**必须修复，否则不能合并。**

关键问题包括：

- 安全性问题
- 正确性问题
- 重大性能问题
- 违反法律或合规问题

### 重要问题

**应该修复，建议在合并前修复。**

重要问题包括：

- 代码可读性问题
- 代码可维护性问题
- 潜在的bug
- 性能问题

### 建议

**可以修复，但不强制。**

建议包括：

- 代码风格改进
- 命名改进
- 文档改进

## 常见错误

### 不进行自我审查

不要直接请求审查而不进行自我审查。自我审查可以捕获许多问题。

### 不运行测试

不要请求审查而不运行测试。测试失败会浪费审查者的时间。

### 不准备材料

不要请求审查而不准备材料。缺少材料会延迟审查过程。

### 不回应反馈

不要忽略审查反馈。及时回应反馈并实施必要的更改。

### 防御性反馈

不要对反馈采取防御性态度。反馈是为了改进代码质量。

## 示例

### 不好

> **不好方法：**
> - 写完代码
> - 直接请求代码审查
> - 没有自我审查
> - 没有运行测试
> - 没有准备材料

### 好

> **好方法：**
> 
> **自我审查代码：**
> - 检查代码逻辑：正确
> - 检查代码风格：一致
> - 检查命名：清晰
> 
> **运行测试：**
> - 运行相关测试：全部通过
> - 运行完整测试套件：全部通过
> 
> **运行代码质量工具：**
> - 运行 linter：通过
> - 运行类型检查：通过
> 
> **准备审查材料：**
> - 描述更改：添加用户认证功能
> - 相关问题：#123
> - 测试说明：运行 `pytest tests/test_auth.py`
> - 注意事项：无
> 
> **请求代码审查**
